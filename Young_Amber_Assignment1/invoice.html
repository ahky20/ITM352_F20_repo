<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice</title>
</head>
<body>
    <script>
        // code from Invoice4
        
        function generate_item_rows(product_quantities_array) {
          for (i=0; i < product_quantities_array.length; i++) {

            errs = isNonNegInt(product_quantities_array[i],true) 
            if(product_quantities_array[i] == 0) {
              continue;
            }
            if(errs.length == 0) {
          extended_price = products[i].price * product_quantities_array[i];
          subTotal += extended_price;
          } else {
            product_quantities_array[i] = `<span style="color:red;">${product_quantities_array[i]}<br>${errs.join("<br>")}</span>`
          }
          document.write(`
      <tr>
        <td width="43%">${products[i].name}</td>
        <td align="center" width="11%">${product_quantities_array[i]}</td>
        <td width="13%">\$ ${products[i].price}</td>
        <td width="54%">\$ ${extended_price}</td>
      </tr>
      `);
      }

        }

    function isNonNegInt(stringToCheck, returnErrors = false) {
      errors = []; // assume no errors at first
      if(Number(stringToCheck) != stringToCheck) errors.push('Not a number!'); // Check if string is a number value
      if(stringToCheck < 0) errors.push('Negative value!'); // Check if it is non-negative
      if(parseInt(stringToCheck) != stringToCheck) errors.push('Not an integer!'); // Check that it is an integer
      return returnErrors ? errors : (errors.length == 0) //simpler way of doing the things commented out below
    }
        // Product Data
        var products = [
//Product 1
{ 
        "name":"Moon Ball",
        "price":3.00,
        "image":"https://cdn.bulbagarden.net/upload/0/0e/SugimoriMoonBall.png",
        "description": "Makes it easier to catch Pokémon that can evolve using a Moon Stone."
    },
    // Product 2
    { 
        "name":"Friend Ball",
        "price":3.00,
        "image":"https://cdn.bulbagarden.net/upload/4/4d/SugimoriFriendBall.png",
        "description": "Makes Pokémon caught in this Poké Ball more friendly towards you immediately."
    },
    // Product 3
    { 
        "name":"Net Ball",
        "price":10.00,
        "image":"https://cdn.bulbagarden.net/upload/e/ed/SugimoriNetBall.png",
        "description": "More effective in catching Water or Bug type Pokémon."
    },
    // Product 4
    { 
        "name":"Dive Ball",
        "price":10.00,
        "image":"https://cdn.bulbagarden.net/upload/8/85/SugimoriDiveBall.png",
        "description": "Works especially well with Pokémon that live underwater."
    },
    // Product 5
    { 
        "name":"Luxury Ball",
        "price":10.00,
        "image":"https://cdn.bulbagarden.net/upload/b/b1/SugimoriLuxuryBall.png",
        "description": "A comfortable Poké Ball, Pokémon quickly grow friendly after being caught."
    },
    // Product 6
    {
        "name":"Premier Ball",
        "price":20.00,
        "image":"https://cdn.bulbagarden.net/upload/a/a1/SugimoriPremierBall.png",
        "description": "Somewhat rare, made as a commerative item used to celebrate an event of some sort."
    }
];
        var quantities =[0,1,2,3,4,5];
        

     // Initialize subtotal
     var subTotal = 0;

     // shipping
     if (subTotal <= 50) {
       shipping = 2;
     }
     else if (subTotal <= 100) {
       shipping = 5;
     }
     else {
       shipping = 0.05 * 100;
     }

    </script>

<table border="2">
    <tbody>
      <tr>
        <th style="text-align: center;" width="43%">Item</th>
        <th style="text-align: center;" width="11%">quantity</th>
        <th style="text-align: center;" width="13%">price</th>
        <th style="text-align: center;" width="54%">extended price</th>
      </tr>
      <script>
          // Product row 1
          generate_item_rows(quantities);
      

      // sales tax and tax rate
      var taxRate = 0.0575;
      var salesTax = subTotal * taxRate;

     // grand total 
     var grandTotal = subTotal + salesTax + shipping;

      </script>
      <tr>
        <td colspan="4" width="100%">&nbsp;</td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%">Sub-total</td>
        <td width="54%">$ <script>document.write(subTotal);</script></td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Tax @ <script>document.write(taxRate * 100);</script>%</span></td>
        <td width="54%">$ <script>document.write(salesTax.toFixed(2));</script></td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Shipping</span></td>
        <td width="54%">$ <script>document.write(shipping.toFixed(2));</script></td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%"><strong>Total</strong></td>
        <td width="54%"><strong>$ <script>document.write(grandTotal.toFixed(2));</script></strong></td>
      </tr>
    </tbody>
  </table>
  
  <b>
    OUR SHIPPING POLICY IS:A subtotal $0 - $49.99 will be $2 shipping
A subtotal $50 - $99.99 will be $5 shipping
Subtotals over $100 will be charged 5% of the subtotal amount
  </b>
</body>
</html>